{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export const AuthProvider=_ref=>{let{children}=_ref;const[auth,setAuth]=useState(()=>{const storedAuth=localStorage.getItem('auth');return storedAuth?JSON.parse(storedAuth):{user:null,userId:null,token:null,isAuthenticated:false};});const[serverError,setServerError]=useState(null);const[loading,setLoading]=useState(false);const navigate=useNavigate();const getuserId=()=>{return localStorage.getItem('userId');};useEffect(()=>{const storedUser=localStorage.getItem('user');const storedUserId=localStorage.getItem('userId');const storedaccessToken=localStorage.getItem('accessToken');if(storedUser&&storedUserId&&storedaccessToken){setAuth({user:JSON.parse(storedUser),userId:storedUserId,token:storedaccessToken,isAuthenticated:true});}},[]);const handleRegister=async values=>{setLoading(true);try{const response=await axios.post('https://api.freeapi.app/api/v1/users/register',values);if(response.data.success){const{user,userId}=response.data.data;localStorage.setItem('user',JSON.stringify(user));localStorage.setItem('userId',user._id);localStorage.setItem('accessToken',response.data.data.accessToken);setAuth({user,userId,token:response.data.data.accessToken,isAuthenticated:true});console.log(response.data);navigate('/dashboard');}else{throw new Error(response.data.message||'Registration failed');}}catch(error){console.error('Signup failed:',error.message);alert(error.message||'An error occurred during registration');}finally{setLoading(false);}};const handleLogin=async credentials=>{try{const response=await axios.post('https://api.freeapi.app/api/v1/users/login',credentials);if(response.data.success){const{user}=response.data.data;localStorage.setItem('user',JSON.stringify(user));localStorage.setItem('userId',user._id);localStorage.setItem('accessToken',response.data.data.accessToken);setAuth({user,userId:user._id,token:response.data.data.accessToken,isAuthenticated:true});navigate('/dashboard');console.log('Login successful:',user);}else{throw new Error(response.data.message||'Login failed');}}catch(error){var _error$response;if(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===404){alert('User does not exist. Please register first.');}else{console.error('Login failed:',error.message);alert(error.message||'An error occurred during login.');}}};const logout=()=>{localStorage.removeItem('user');localStorage.removeItem('userId');localStorage.removeItem('accessToken');setAuth({user:null,userId:null,token:null,isAuthenticated:false});navigate('/login');};useEffect(()=>{const userId=localStorage.getItem('userId');const user=JSON.parse(localStorage.getItem('user'));const token=localStorage.getItem('accessToken');if(userId&&user&&token){setAuth({userId,user,token,isAuthenticated:true});}},[]);return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{auth,setAuth,handleRegister,handleLogin,getuserId,logout,loading,setLoading,serverError,setServerError},children:children});};export const useAuth=()=>useContext(AuthContext);","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","axios","useNavigate","jsx","_jsx","AuthContext","AuthProvider","_ref","children","auth","setAuth","storedAuth","localStorage","getItem","JSON","parse","user","userId","token","isAuthenticated","serverError","setServerError","loading","setLoading","navigate","getuserId","storedUser","storedUserId","storedaccessToken","handleRegister","values","response","post","data","success","setItem","stringify","_id","accessToken","console","log","Error","message","error","alert","handleLogin","credentials","_error$response","status","logout","removeItem","Provider","value","useAuth"],"sources":["C:/Users/aisha/OneDrive/Desktop/Auth Dashboard/auth-dashboard/src/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n    \r\n    const [auth, setAuth] = useState(() => {\r\n        const storedAuth = localStorage.getItem('auth');\r\n        return storedAuth ? JSON.parse(storedAuth) : {\r\n            user: null,\r\n            userId: null,\r\n            token: null,\r\n            isAuthenticated: false\r\n        };\r\n    });\r\n\r\n    const [serverError, setServerError] = useState(null);\r\n    const [loading, setLoading] = useState(false);\r\n    const navigate = useNavigate();\r\n\r\n    const getuserId = () => {\r\n        return localStorage.getItem('userId');\r\n    };\r\n\r\n    useEffect(() => {\r\n        const storedUser = localStorage.getItem('user');\r\n        const storedUserId = localStorage.getItem('userId');\r\n        const storedaccessToken = localStorage.getItem('accessToken');\r\n        \r\n        if (storedUser && storedUserId && storedaccessToken) {\r\n            setAuth({\r\n                user: JSON.parse(storedUser),\r\n                userId: storedUserId,\r\n                token: storedaccessToken,\r\n                isAuthenticated: true,\r\n            });\r\n        }\r\n    }, []);\r\n\r\n    const handleRegister = async (values) => {\r\n        setLoading(true);\r\n        try {\r\n            const response = await axios.post('https://api.freeapi.app/api/v1/users/register', values);\r\n\r\n            if (response.data.success) {\r\n                const { user, userId } = response.data.data;\r\n\r\n                localStorage.setItem('user', JSON.stringify(user));\r\n                localStorage.setItem('userId', user._id);\r\n                localStorage.setItem('accessToken', response.data.data.accessToken);\r\n                setAuth({ user, userId, token: response.data.data.accessToken, isAuthenticated: true });\r\n                console.log(response.data);\r\n                navigate('/dashboard');\r\n            } else {\r\n                throw new Error(response.data.message || 'Registration failed');\r\n            }\r\n        } catch (error) {\r\n            console.error('Signup failed:', error.message);\r\n            alert(error.message || 'An error occurred during registration');\r\n        }\r\n        finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleLogin = async (credentials) => {\r\n        try {\r\n            const response = await axios.post('https://api.freeapi.app/api/v1/users/login', credentials);\r\n            if (response.data.success) {\r\n                const { user } = response.data.data;\r\n\r\n                localStorage.setItem('user', JSON.stringify(user));\r\n                localStorage.setItem('userId', user._id);\r\n                localStorage.setItem('accessToken', response.data.data.accessToken);\r\n\r\n                setAuth({ user, userId: user._id, token: response.data.data.accessToken, isAuthenticated: true });\r\n                navigate('/dashboard');\r\n                console.log('Login successful:', user);\r\n            } else {\r\n                throw new Error(response.data.message || 'Login failed');\r\n            }\r\n        } catch (error) {\r\n            if (error.response?.status === 404) {\r\n                alert('User does not exist. Please register first.');\r\n            } else {\r\n                console.error('Login failed:', error.message);\r\n                alert(error.message || 'An error occurred during login.');\r\n            }\r\n        }\r\n    };\r\n\r\n    const logout = () => {\r\n        localStorage.removeItem('user');\r\n        localStorage.removeItem('userId');\r\n        localStorage.removeItem('accessToken');\r\n        setAuth({ user: null, userId: null, token: null, isAuthenticated: false });\r\n\r\n        navigate('/login');\r\n    };\r\n\r\n    useEffect(() => {\r\n        const userId = localStorage.getItem('userId');\r\n        const user = JSON.parse(localStorage.getItem('user'));\r\n        const token = localStorage.getItem('accessToken');\r\n\r\n        if (userId && user && token) {\r\n            setAuth({\r\n                userId,\r\n                user,\r\n                token,\r\n                isAuthenticated: true\r\n            });\r\n        } \r\n    }, []);\r\n\r\n    return (\r\n        <AuthContext.Provider value={{\r\n            auth,\r\n            setAuth,\r\n            handleRegister,\r\n            handleLogin,\r\n            getuserId,\r\n            logout,\r\n            loading,\r\n            setLoading,\r\n            serverError,\r\n            setServerError\r\n        }}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useAuth = () => useContext(AuthContext);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}